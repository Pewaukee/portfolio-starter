<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>b4d1dbc13a08489b81ce194be76378d2</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<div id="830e425a" class="cell markdown"
data-papermill="{&quot;duration&quot;:1.0091e-2,&quot;end_time&quot;:&quot;2023-08-28T18:22:50.625370&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2023-08-28T18:22:50.615279&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<h1 id="tamil-handwritten-character-recognition">Tamil Handwritten
Character Recognition</h1>
<p>In this notebook, we are going to take a look at trying to use
convolutional neural networks in order to try and estimate what
character of Tamil is written based on a given input. Let's try and work
through that.</p>
</div>
<div id="3b9537cc" class="cell markdown"
data-papermill="{&quot;duration&quot;:9.185e-3,&quot;end_time&quot;:&quot;2023-08-28T18:22:50.644860&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2023-08-28T18:22:50.635675&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<h1 id="imports">Imports</h1>
</div>
<div id="e904b905" class="cell code" data-execution_count="1"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-08-28T18:22:50.665414Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-08-28T18:22:50.664889Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-08-28T18:22:58.809428Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-08-28T18:22:58.808414Z&quot;}"
data-papermill="{&quot;duration&quot;:8.157768,&quot;end_time&quot;:&quot;2023-08-28T18:22:58.812019&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2023-08-28T18:22:50.654251&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<div class="sourceCode" id="cb1"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> shutil</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> PIL <span class="im">import</span> Image <span class="co"># image processing</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tensorflow <span class="im">as</span> tf</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow <span class="im">import</span> keras</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras <span class="im">import</span> layers</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.utils <span class="im">import</span> image_dataset_from_directory <span class="co"># load images from directory</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras <span class="im">import</span> callbacks <span class="co"># use EarlyStopping</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Reproducability</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> set_seed(seed<span class="op">=</span><span class="dv">31415</span>):</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>    np.random.seed(seed)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>    tf.random.set_seed(seed)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    os.environ[<span class="st">&#39;PYTHONHASHSEED&#39;</span>] <span class="op">=</span> <span class="bu">str</span>(seed)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    os.environ[<span class="st">&#39;TF_DETERMINISTIC_OPS&#39;</span>] <span class="op">=</span> <span class="st">&#39;1&#39;</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>set_seed(<span class="dv">31415</span>)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Set Matplotlib defaults</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>plt.rc(<span class="st">&#39;figure&#39;</span>, autolayout<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>plt.rc(<span class="st">&#39;axes&#39;</span>, labelweight<span class="op">=</span><span class="st">&#39;bold&#39;</span>, labelsize<span class="op">=</span><span class="st">&#39;large&#39;</span>,</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>       titleweight<span class="op">=</span><span class="st">&#39;bold&#39;</span>, titlesize<span class="op">=</span><span class="dv">18</span>, titlepad<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>plt.rc(<span class="st">&#39;image&#39;</span>, cmap<span class="op">=</span><span class="st">&#39;magma&#39;</span>)</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">&quot;ignore&quot;</span>) <span class="co"># to clean up output cells</span></span></code></pre></div>
<div class="output stream stderr">
<pre><code>/opt/conda/lib/python3.10/site-packages/scipy/__init__.py:146: UserWarning: A NumPy version &gt;=1.16.5 and &lt;1.23.0 is required for this version of SciPy (detected version 1.23.5
  warnings.warn(f&quot;A NumPy version &gt;={np_minversion} and &lt;{np_maxversion}&quot;
/opt/conda/lib/python3.10/site-packages/tensorflow_io/python/ops/__init__.py:98: UserWarning: unable to load libtensorflow_io_plugins.so: unable to open file: libtensorflow_io_plugins.so, from paths: [&#39;/opt/conda/lib/python3.10/site-packages/tensorflow_io/python/ops/libtensorflow_io_plugins.so&#39;]
caused by: [&#39;/opt/conda/lib/python3.10/site-packages/tensorflow_io/python/ops/libtensorflow_io_plugins.so: undefined symbol: _ZN3tsl6StatusC1EN10tensorflow5error4CodeESt17basic_string_viewIcSt11char_traitsIcEENS_14SourceLocationE&#39;]
  warnings.warn(f&quot;unable to load libtensorflow_io_plugins.so: {e}&quot;)
/opt/conda/lib/python3.10/site-packages/tensorflow_io/python/ops/__init__.py:104: UserWarning: file system plugins are not loaded: unable to open file: libtensorflow_io.so, from paths: [&#39;/opt/conda/lib/python3.10/site-packages/tensorflow_io/python/ops/libtensorflow_io.so&#39;]
caused by: [&#39;/opt/conda/lib/python3.10/site-packages/tensorflow_io/python/ops/libtensorflow_io.so: undefined symbol: _ZTVN10tensorflow13GcsFileSystemE&#39;]
  warnings.warn(f&quot;file system plugins are not loaded: {e}&quot;)
</code></pre>
</div>
</div>
<div id="6239084e" class="cell markdown"
data-papermill="{&quot;duration&quot;:9.773e-3,&quot;end_time&quot;:&quot;2023-08-28T18:22:58.832181&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2023-08-28T18:22:58.822408&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<h2 id="load-training-data">Load Training Data</h2>
<p>Now, let's load the training data from the kaggle input
directory.</p>
</div>
<div id="fd405302" class="cell code" data-execution_count="2"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-08-28T18:22:58.853478Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-08-28T18:22:58.852877Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-08-28T18:22:58.939252Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-08-28T18:22:58.938286Z&quot;}"
data-papermill="{&quot;duration&quot;:9.9756e-2,&quot;end_time&quot;:&quot;2023-08-28T18:22:58.941718&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2023-08-28T18:22:58.841962&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<div class="sourceCode" id="cb3"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>df_train <span class="op">=</span> pd.read_csv(<span class="st">&#39;/kaggle/input/tamil-hwcr/train.csv&#39;</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>df_test <span class="op">=</span> pd.read_csv(<span class="st">&#39;/kaggle/input/tamil-hwcr/test.csv&#39;</span>)</span></code></pre></div>
</div>
<div id="4f3631e9" class="cell code" data-execution_count="3"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-08-28T18:22:58.964483Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-08-28T18:22:58.962980Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-08-28T18:22:59.004902Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-08-28T18:22:59.003998Z&quot;}"
data-papermill="{&quot;duration&quot;:5.5031e-2,&quot;end_time&quot;:&quot;2023-08-28T18:22:59.007066&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2023-08-28T18:22:58.952035&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<div class="sourceCode" id="cb4"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>df_train.info()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 62870 entries, 0 to 62869
Data columns (total 2 columns):
 #   Column       Non-Null Count  Dtype 
---  ------       --------------  ----- 
 0   ID           62870 non-null  object
 1   Class Label  62870 non-null  int64 
dtypes: int64(1), object(1)
memory usage: 982.5+ KB
</code></pre>
</div>
</div>
<div id="977235a0" class="cell code" data-execution_count="4"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-08-28T18:22:59.029175Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-08-28T18:22:59.027723Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-08-28T18:22:59.044435Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-08-28T18:22:59.043516Z&quot;}"
data-papermill="{&quot;duration&quot;:2.9738e-2,&quot;end_time&quot;:&quot;2023-08-28T18:22:59.046824&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2023-08-28T18:22:59.017086&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<div class="sourceCode" id="cb6"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>df_train.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="4">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>Class Label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.bmp</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2.bmp</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3.bmp</td>
      <td>4</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4.bmp</td>
      <td>5</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5.bmp</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div id="596761c9" class="cell markdown"
data-papermill="{&quot;duration&quot;:9.675e-3,&quot;end_time&quot;:&quot;2023-08-28T18:22:59.067242&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2023-08-28T18:22:59.057567&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<h1 id="priliminary-data-analysis">Priliminary Data Analysis</h1>
<p>Now, let's take a first look at the data by inspecting the BMP Files
given as the input for both dataframes. Then, we'll keep exploring.</p>
</div>
<div id="844171a4" class="cell code" data-execution_count="5"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-08-28T18:22:59.088435Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-08-28T18:22:59.088171Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-08-28T18:22:59.110106Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-08-28T18:22:59.108988Z&quot;}"
data-papermill="{&quot;duration&quot;:3.5101e-2,&quot;end_time&quot;:&quot;2023-08-28T18:22:59.112174&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2023-08-28T18:22:59.077073&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<div class="sourceCode" id="cb7"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># find the size of an image</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>width, height <span class="op">=</span> Image.<span class="bu">open</span>(</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;/kaggle/input/tamil-hwcr/Train-Kaggle/Train-Kaggle/1.bmp&#39;</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>).size</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;Width: </span><span class="sc">{</span>width<span class="sc">}</span><span class="ss">px, Height: </span><span class="sc">{</span>height<span class="sc">}</span><span class="ss">px&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Width: 64px, Height: 64px
</code></pre>
</div>
</div>
<div id="511752d5" class="cell code" data-execution_count="6"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-08-28T18:22:59.134624Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-08-28T18:22:59.133246Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-08-28T18:22:59.983133Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-08-28T18:22:59.981787Z&quot;}"
data-papermill="{&quot;duration&quot;:0.864296,&quot;end_time&quot;:&quot;2023-08-28T18:22:59.986607&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2023-08-28T18:22:59.122311&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<div class="sourceCode" id="cb9"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>examples <span class="op">=</span> <span class="dv">5</span> <span class="co"># modify if desired</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> index <span class="kw">in</span> <span class="bu">range</span>(examples):</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    image_file <span class="op">=</span> df_train[<span class="st">&#39;ID&#39;</span>][index]</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    image_path <span class="op">=</span> os.path.join(</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;/kaggle/input/tamil-hwcr/Train-Kaggle/Train-Kaggle/&#39;</span>,</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>        image_file</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    img <span class="op">=</span> Image.<span class="bu">open</span>(image_path)</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    plt.imshow(img)</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="ss">f&#39;Image: </span><span class="sc">{</span>image_file<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    plt.axis(<span class="st">&#39;off&#39;</span>)</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>    plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_e131fcf5d1b6404db820e273fc47da45/d8f69c21f6f30a7548695697f4fad97387ba9467.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_e131fcf5d1b6404db820e273fc47da45/c208bd0517858721b8a4348063570c738339715c.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_e131fcf5d1b6404db820e273fc47da45/9a343bec2c75248b7f0c6e123383c26800b60eef.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_e131fcf5d1b6404db820e273fc47da45/aba8a169a375e4e850e5a35087adccd4338f5f7c.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_e131fcf5d1b6404db820e273fc47da45/32f511dcfbcbf820b752f4222b1fa675110348bc.png" /></p>
</div>
</div>
<div id="9dd419ef" class="cell code" data-execution_count="7"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-08-28T18:23:00.031228Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-08-28T18:23:00.030926Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-08-28T18:23:00.035336Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-08-28T18:23:00.034292Z&quot;}"
data-papermill="{&quot;duration&quot;:2.4089e-2,&quot;end_time&quot;:&quot;2023-08-28T18:23:00.037635&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2023-08-28T18:23:00.013546&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<div class="sourceCode" id="cb10"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>label <span class="op">=</span> <span class="st">&#39;Class Label&#39;</span></span></code></pre></div>
</div>
<div id="c52108d9" class="cell code" data-execution_count="8"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-08-28T18:23:00.061508Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-08-28T18:23:00.061236Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-08-28T18:23:00.068521Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-08-28T18:23:00.067539Z&quot;}"
data-papermill="{&quot;duration&quot;:2.1868e-2,&quot;end_time&quot;:&quot;2023-08-28T18:23:00.070656&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2023-08-28T18:23:00.048788&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<div class="sourceCode" id="cb11"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># how many class labels are we classifing? 156 different characters</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(df_train[label].unique())</span></code></pre></div>
<div class="output execute_result" data-execution_count="8">
<pre><code>156</code></pre>
</div>
</div>
<div id="883b5dbe" class="cell code" data-execution_count="9"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-08-28T18:23:00.094770Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-08-28T18:23:00.094499Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-08-28T18:23:00.110077Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-08-28T18:23:00.109164Z&quot;}"
data-papermill="{&quot;duration&quot;:3.0046e-2,&quot;end_time&quot;:&quot;2023-08-28T18:23:00.112243&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2023-08-28T18:23:00.082197&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<div class="sourceCode" id="cb13"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>df_train[label].describe()</span></code></pre></div>
<div class="output execute_result" data-execution_count="9">
<pre><code>count    62870.000000
mean        77.601861
std         44.977283
min          0.000000
25%         39.000000
50%         78.000000
75%        116.000000
max        155.000000
Name: Class Label, dtype: float64</code></pre>
</div>
</div>
<div id="c9813dff" class="cell code" data-execution_count="10"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-08-28T18:23:00.138531Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-08-28T18:23:00.137510Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-08-28T18:23:00.750629Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-08-28T18:23:00.749688Z&quot;}"
data-papermill="{&quot;duration&quot;:0.628407,&quot;end_time&quot;:&quot;2023-08-28T18:23:00.752971&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2023-08-28T18:23:00.124564&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<div class="sourceCode" id="cb15"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># what is the historgram of the Class Lebels?</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>plt.hist(df_train[label], bins<span class="op">=</span><span class="dv">50</span>, color<span class="op">=</span><span class="st">&#39;blue&#39;</span>, edgecolor<span class="op">=</span><span class="st">&#39;black&#39;</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Add labels and title</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Character&#39;</span>)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Frequency&#39;</span>)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Histogram of Characters&#39;</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="10">
<pre><code>Text(0.5, 1.0, &#39;Histogram of Characters&#39;)</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_e131fcf5d1b6404db820e273fc47da45/8f5cc0f0961b78c863b481e2737f0cb30b0be9a0.png" /></p>
</div>
</div>
<div id="0f09e523" class="cell markdown"
data-papermill="{&quot;duration&quot;:1.2492e-2,&quot;end_time&quot;:&quot;2023-08-28T18:23:00.777639&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2023-08-28T18:23:00.765147&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<p>From the following histogram, we can see that the class distribution
is about as balanced as it could be. The few outliers could most likely
be vowels or other highly used characters in the Tamil language.</p>
</div>
<div id="d33c5163" class="cell markdown"
data-papermill="{&quot;duration&quot;:1.1919e-2,&quot;end_time&quot;:&quot;2023-08-28T18:23:00.801572&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2023-08-28T18:23:00.789653&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<h1 id="constructing-the-required-data">Constructing the Required
Data</h1>
<p>Because we are dealing with images as the input, we need to get the
filenames from the dataframe <code>df_train</code>, or look in the
<code>/kaggle/input/tamil-hwcr/Train-Kaggle/Train-Kaggle/</code>
directory for the training files, and then split those pictures into
training and validation data, then pass it in along with the labels from
the dataframe into the model to train. In order to do that, we will use
tensorflow's <code>image_dataset_from_directory</code> module. Check out
the following [link](<a
href="https://www.tensorflow.org/tutorials/images/classification#"
class="uri">https://www.tensorflow.org/tutorials/images/classification#</a>:~:text=train_ds%20%3D-,tf.keras.utils.image_dataset_from_directory,-(%0A%C2%A0%20data_dir%2C)
to understand how to use this module better.</p>
</div>
<div id="ed88d278" class="cell code" data-execution_count="11"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-08-28T18:23:00.826889Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-08-28T18:23:00.826577Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-08-28T18:23:00.831047Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-08-28T18:23:00.830120Z&quot;}"
data-papermill="{&quot;duration&quot;:1.9745e-2,&quot;end_time&quot;:&quot;2023-08-28T18:23:00.833047&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2023-08-28T18:23:00.813302&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<div class="sourceCode" id="cb17"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>image_train_directory <span class="op">=</span> <span class="st">&#39;/kaggle/input/tamil-hwcr/Train-Kaggle/Train-Kaggle/&#39;</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>image_test_directory <span class="op">=</span> <span class="st">&#39;/kaggle/input/tamil-hwcr/Test-Kaggle/Test-Kaggle/&#39;</span></span></code></pre></div>
</div>
<div id="1237cb8f" class="cell markdown"
data-papermill="{&quot;duration&quot;:1.1712e-2,&quot;end_time&quot;:&quot;2023-08-28T18:23:00.856498&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2023-08-28T18:23:00.844786&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<p>In order to construct the correct matchings of Class Label to file,
we need to order the dataframe by alphanumeric order of the
<code>ID</code> column. Then, we can match the correct labels to the
data.</p>
</div>
<div id="0d8bc68a" class="cell code" data-execution_count="12"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-08-28T18:23:00.881898Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-08-28T18:23:00.881059Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-08-28T18:23:01.000597Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-08-28T18:23:00.999546Z&quot;}"
data-papermill="{&quot;duration&quot;:0.135005,&quot;end_time&quot;:&quot;2023-08-28T18:23:01.003253&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2023-08-28T18:23:00.868248&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<div class="sourceCode" id="cb18"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>df_train <span class="op">=</span> df_train.sort_values(by<span class="op">=</span><span class="st">&#39;ID&#39;</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>df_test <span class="op">=</span> df_test.sort_values(by<span class="op">=</span><span class="st">&#39;ID&#39;</span>)</span></code></pre></div>
</div>
<div id="e056fbcd" class="cell code" data-execution_count="13"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-08-28T18:23:01.032566Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-08-28T18:23:01.032230Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-08-28T18:28:15.070299Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-08-28T18:28:15.069325Z&quot;}"
data-papermill="{&quot;duration&quot;:314.055303,&quot;end_time&quot;:&quot;2023-08-28T18:28:15.072743&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2023-08-28T18:23:01.017440&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<div class="sourceCode" id="cb19"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># &#39;Class Label&#39; output values for training set</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>train_labels <span class="op">=</span> df_train[label].tolist()</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co"># create the training and validation subsets</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>train_ds, val_ds <span class="op">=</span> image_dataset_from_directory(</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    image_train_directory,</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    labels<span class="op">=</span>train_labels,</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    label_mode<span class="op">=</span><span class="st">&#39;int&#39;</span>,</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    validation_split<span class="op">=</span><span class="fl">0.2</span>, <span class="co"># 20% for validation</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>    subset<span class="op">=</span><span class="st">&#39;both&#39;</span>, <span class="co"># return tuple of training and validation</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>    seed<span class="op">=</span><span class="dv">123</span>, <span class="co"># random seed for no overlap of training and validation</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>    image_size<span class="op">=</span>(<span class="dv">64</span>,<span class="dv">64</span>), <span class="co"># corresponding image size</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>    batch_size<span class="op">=</span><span class="dv">32</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>test_ds <span class="op">=</span> image_dataset_from_directory(</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>    image_test_directory,</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>    labels<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>    label_mode<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>    image_size<span class="op">=</span>(<span class="dv">64</span>,<span class="dv">64</span>)</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Found 62870 files belonging to 156 classes.
Using 50296 files for training.
Using 12574 files for validation.
Found 28080 files belonging to 1 classes.
</code></pre>
</div>
</div>
<div id="639e5ef0" class="cell markdown"
data-papermill="{&quot;duration&quot;:1.2081e-2,&quot;end_time&quot;:&quot;2023-08-28T18:28:15.097339&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2023-08-28T18:28:15.085258&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<h1 id="configure-the-dataset-for-performance">Configure the Dataset for
performance</h1>
<p>Because we are using images, we need to use buffered prefetching so
that we don't continuously try to reload the images. This way, when
running consequentive epochs, we will have the images stored in a cache.
This is particularly helpful for a large dataset like we have here.
Check out this <a
href="https://www.tensorflow.org/tutorials/images/classification#configure_the_dataset_for_performance">link</a>
for example implementation on the tensorflow website.</p>
</div>
<div id="2f8b448c" class="cell code" data-execution_count="14"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-08-28T18:28:15.124829Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-08-28T18:28:15.123150Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-08-28T18:28:15.139332Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-08-28T18:28:15.138452Z&quot;}"
data-papermill="{&quot;duration&quot;:3.1861e-2,&quot;end_time&quot;:&quot;2023-08-28T18:28:15.141673&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2023-08-28T18:28:15.109812&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<div class="sourceCode" id="cb21"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>AUTOTUNE <span class="op">=</span> tf.data.AUTOTUNE</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>train_ds <span class="op">=</span> train_ds.cache().shuffle(<span class="dv">1000</span>).prefetch(buffer_size<span class="op">=</span>AUTOTUNE)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>val_ds <span class="op">=</span> val_ds.cache().prefetch(buffer_size<span class="op">=</span>AUTOTUNE)</span></code></pre></div>
</div>
<div id="cb0a76da" class="cell markdown"
data-papermill="{&quot;duration&quot;:1.1931e-2,&quot;end_time&quot;:&quot;2023-08-28T18:28:15.165720&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2023-08-28T18:28:15.153789&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<h1 id="constructing-a-model">Constructing a Model</h1>
<p>For the following model, it is going to be quite simple, starting
with a little preprocessing which will tilt each image slightly to
adjust for angles in writing, continuing with a few blocks of
convolution -&gt; relu -&gt; pooling, and ending with some dense layers
as the classifier head.</p>
<p>In the conolutional blocks, we are going to double our
<code>filters</code> value over subsequent layers and set a small
<code>kernel_size</code> parameter. The <code>filters</code> argument
may have to be tuned, however, the <code>kernel_size</code> should
likely be small in order to differentiate between very small differences
between characters. We will gradually decrease the kernel size as we
progress through the network.</p>
<h5 id="note">Note:</h5>
<p>The reason for doubling the filters value is to perform the
following, among more benefits:</p>
<ul>
<li>Learn a feature hierarchy</li>
<li>Allow the model to capture more complex features</li>
</ul>
</div>
<div id="52bec865" class="cell code" data-execution_count="15"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-08-28T18:28:15.191445Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-08-28T18:28:15.191155Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-08-28T18:28:15.582571Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-08-28T18:28:15.581825Z&quot;}"
data-papermill="{&quot;duration&quot;:0.429436,&quot;end_time&quot;:&quot;2023-08-28T18:28:15.607252&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2023-08-28T18:28:15.177816&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<div class="sourceCode" id="cb22"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> keras.Sequential([</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># rescale the image to one color channel, but still include input shape with 3 color channel</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    layers.Rescaling(<span class="fl">1.</span><span class="op">/</span><span class="dv">255</span>, input_shape<span class="op">=</span>(<span class="dv">64</span>,<span class="dv">64</span>,<span class="dv">3</span>)),</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convolutional Block</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    layers.Conv2D(filters<span class="op">=</span><span class="dv">16</span>, </span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>                  kernel_size<span class="op">=</span><span class="dv">3</span>, </span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>                  activation<span class="op">=</span><span class="st">&#39;relu&#39;</span>, </span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>                  padding<span class="op">=</span><span class="st">&#39;same&#39;</span>),</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    layers.MaxPool2D(),</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    layers.Dropout(<span class="fl">0.25</span>),</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convolutional Block #2</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>    layers.Conv2D(filters<span class="op">=</span><span class="dv">32</span>, </span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>                  kernel_size<span class="op">=</span><span class="dv">2</span>, </span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>                  activation<span class="op">=</span><span class="st">&#39;relu&#39;</span>, </span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>                  padding<span class="op">=</span><span class="st">&#39;same&#39;</span>),</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>    layers.MaxPool2D(),</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>    layers.Dropout(<span class="fl">0.25</span>),</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convolutional Block #3</span></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>    layers.Conv2D(filters<span class="op">=</span><span class="dv">64</span>, </span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>                  kernel_size<span class="op">=</span><span class="dv">2</span>, </span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>                  activation<span class="op">=</span><span class="st">&#39;relu&#39;</span>, </span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>                  padding<span class="op">=</span><span class="st">&#39;same&#39;</span>),</span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>    layers.MaxPool2D(),</span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>    layers.Dropout(<span class="fl">0.25</span>),</span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Classifier Head</span></span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>    layers.Flatten(),</span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>    layers.Dense(units<span class="op">=</span><span class="dv">256</span>, activation<span class="op">=</span><span class="st">&#39;relu&#39;</span>),</span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a>    layers.Dropout(<span class="fl">0.50</span>),</span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a>    <span class="co"># end layer with as many units as possible classes</span></span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a>    layers.Dense(units<span class="op">=</span><span class="dv">156</span>, activation<span class="op">=</span><span class="st">&#39;softmax&#39;</span>)</span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a>model.summary()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Model: &quot;sequential&quot;
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 rescaling (Rescaling)       (None, 64, 64, 3)         0         
                                                                 
 conv2d (Conv2D)             (None, 64, 64, 16)        448       
                                                                 
 max_pooling2d (MaxPooling2D  (None, 32, 32, 16)       0         
 )                                                               
                                                                 
 dropout (Dropout)           (None, 32, 32, 16)        0         
                                                                 
 conv2d_1 (Conv2D)           (None, 32, 32, 32)        2080      
                                                                 
 max_pooling2d_1 (MaxPooling  (None, 16, 16, 32)       0         
 2D)                                                             
                                                                 
 dropout_1 (Dropout)         (None, 16, 16, 32)        0         
                                                                 
 conv2d_2 (Conv2D)           (None, 16, 16, 64)        8256      
                                                                 
 max_pooling2d_2 (MaxPooling  (None, 8, 8, 64)         0         
 2D)                                                             
                                                                 
 dropout_2 (Dropout)         (None, 8, 8, 64)          0         
                                                                 
 flatten (Flatten)           (None, 4096)              0         
                                                                 
 dense (Dense)               (None, 256)               1048832   
                                                                 
 dropout_3 (Dropout)         (None, 256)               0         
                                                                 
 dense_1 (Dense)             (None, 156)               40092     
                                                                 
=================================================================
Total params: 1,099,708
Trainable params: 1,099,708
Non-trainable params: 0
_________________________________________________________________
</code></pre>
</div>
</div>
<div id="cc4fe762" class="cell markdown"
data-papermill="{&quot;duration&quot;:1.4843e-2,&quot;end_time&quot;:&quot;2023-08-28T18:28:15.637541&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2023-08-28T18:28:15.622698&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<h3 id="compile-the-model">Compile the model</h3>
<p>We are going to use the <code>adam</code> optimizer, along with the
<code>categorical_crossentopy</code> loss function for classifying
between many different classes, and using a simple accuracy metric.</p>
</div>
<div id="1025d95a" class="cell code" data-execution_count="16"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-08-28T18:28:15.669120Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-08-28T18:28:15.668696Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-08-28T18:28:15.686824Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-08-28T18:28:15.685974Z&quot;}"
data-papermill="{&quot;duration&quot;:3.622e-2,&quot;end_time&quot;:&quot;2023-08-28T18:28:15.688823&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2023-08-28T18:28:15.652603&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<div class="sourceCode" id="cb24"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>model.<span class="bu">compile</span>(optimizer<span class="op">=</span><span class="st">&#39;adam&#39;</span>, </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>              loss<span class="op">=</span>tf.keras.losses.SparseCategoricalCrossentropy(from_logits<span class="op">=</span><span class="va">True</span>), </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>              metrics<span class="op">=</span>[<span class="st">&#39;accuracy&#39;</span>])</span></code></pre></div>
</div>
<div id="ff77ece4" class="cell markdown"
data-papermill="{&quot;duration&quot;:1.4983e-2,&quot;end_time&quot;:&quot;2023-08-28T18:28:15.718918&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2023-08-28T18:28:15.703935&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<h2 id="create-earlystopping-callback">Create EarlyStopping
Callback</h2>
<p>Monitoring the validation loss, we want to stop the training once
after 3 epochs have ran, the validation loss has not decreased by at
least 0.001. Once this happens, restore the best weights that were
calculated from the network.</p>
</div>
<div id="7c5f12a0" class="cell code" data-execution_count="17"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-08-28T18:28:15.750333Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-08-28T18:28:15.749984Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-08-28T18:28:15.756084Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-08-28T18:28:15.755234Z&quot;}"
data-papermill="{&quot;duration&quot;:2.4523e-2,&quot;end_time&quot;:&quot;2023-08-28T18:28:15.758262&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2023-08-28T18:28:15.733739&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<div class="sourceCode" id="cb25"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>early_stopping <span class="op">=</span> callbacks.EarlyStopping(</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>    monitor<span class="op">=</span><span class="st">&#39;val_loss&#39;</span>,</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    min_delta<span class="op">=</span><span class="fl">0.001</span>, </span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    patience<span class="op">=</span><span class="dv">3</span>, </span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    restore_best_weights<span class="op">=</span><span class="va">True</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="4695f431" class="cell markdown"
data-papermill="{&quot;duration&quot;:1.5158e-2,&quot;end_time&quot;:&quot;2023-08-28T18:28:15.788995&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2023-08-28T18:28:15.773837&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<h3 id="run-the-model">Run the Model</h3>
<p>Execute the model on the image generators created for the training
and validation data.</p>
</div>
<div id="e02baec5" class="cell code" data-execution_count="18"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-08-28T18:28:15.822635Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-08-28T18:28:15.822344Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-08-28T18:35:56.348946Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-08-28T18:35:56.344751Z&quot;}"
data-papermill="{&quot;duration&quot;:460.547635,&quot;end_time&quot;:&quot;2023-08-28T18:35:56.351538&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2023-08-28T18:28:15.803903&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<div class="sourceCode" id="cb26"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>history <span class="op">=</span> model.fit(train_ds, </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>                    validation_data<span class="op">=</span>val_ds, </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>                    epochs<span class="op">=</span><span class="dv">100</span>, </span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>                    verbose<span class="op">=</span><span class="dv">1</span>, </span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>                    callbacks<span class="op">=</span>[early_stopping])</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Epoch 1/100
</code></pre>
</div>
<div class="output stream stderr">
<pre><code>2023-08-28 18:28:16.958593: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:954] layout failed: INVALID_ARGUMENT: Size of values 0 does not match size of permutation 4 @ fanin shape insequential/dropout/dropout/SelectV2-2-TransposeNHWCToNCHW-LayoutOptimizer
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>1572/1572 [==============================] - 182s 57ms/step - loss: 2.3398 - accuracy: 0.4384 - val_loss: 0.6012 - val_accuracy: 0.8557
Epoch 2/100
1572/1572 [==============================] - 13s 8ms/step - loss: 0.9544 - accuracy: 0.7332 - val_loss: 0.4004 - val_accuracy: 0.8941
Epoch 3/100
1572/1572 [==============================] - 13s 8ms/step - loss: 0.7270 - accuracy: 0.7917 - val_loss: 0.3231 - val_accuracy: 0.9144
Epoch 4/100
1572/1572 [==============================] - 13s 8ms/step - loss: 0.6130 - accuracy: 0.8221 - val_loss: 0.2807 - val_accuracy: 0.9218
Epoch 5/100
1572/1572 [==============================] - 13s 8ms/step - loss: 0.5368 - accuracy: 0.8406 - val_loss: 0.2603 - val_accuracy: 0.9291
Epoch 6/100
1572/1572 [==============================] - 13s 8ms/step - loss: 0.4781 - accuracy: 0.8568 - val_loss: 0.2291 - val_accuracy: 0.9338
Epoch 7/100
1572/1572 [==============================] - 13s 8ms/step - loss: 0.4267 - accuracy: 0.8727 - val_loss: 0.2007 - val_accuracy: 0.9403
Epoch 8/100
1572/1572 [==============================] - 13s 8ms/step - loss: 0.3959 - accuracy: 0.8806 - val_loss: 0.1960 - val_accuracy: 0.9444
Epoch 9/100
1572/1572 [==============================] - 13s 8ms/step - loss: 0.3655 - accuracy: 0.8902 - val_loss: 0.2026 - val_accuracy: 0.9418
Epoch 10/100
1572/1572 [==============================] - 13s 8ms/step - loss: 0.3356 - accuracy: 0.8960 - val_loss: 0.1761 - val_accuracy: 0.9485
Epoch 11/100
1572/1572 [==============================] - 13s 8ms/step - loss: 0.3173 - accuracy: 0.9020 - val_loss: 0.1843 - val_accuracy: 0.9476
Epoch 12/100
1572/1572 [==============================] - 13s 8ms/step - loss: 0.2977 - accuracy: 0.9076 - val_loss: 0.1877 - val_accuracy: 0.9450
Epoch 13/100
1572/1572 [==============================] - 13s 8ms/step - loss: 0.2862 - accuracy: 0.9098 - val_loss: 0.1715 - val_accuracy: 0.9466
Epoch 14/100
1572/1572 [==============================] - 13s 8ms/step - loss: 0.2677 - accuracy: 0.9154 - val_loss: 0.1797 - val_accuracy: 0.9466
Epoch 15/100
1572/1572 [==============================] - 13s 8ms/step - loss: 0.2591 - accuracy: 0.9176 - val_loss: 0.1666 - val_accuracy: 0.9505
Epoch 16/100
1572/1572 [==============================] - 13s 8ms/step - loss: 0.2496 - accuracy: 0.9219 - val_loss: 0.1563 - val_accuracy: 0.9536
Epoch 17/100
1572/1572 [==============================] - 13s 8ms/step - loss: 0.2373 - accuracy: 0.9234 - val_loss: 0.1609 - val_accuracy: 0.9512
Epoch 18/100
1572/1572 [==============================] - 13s 8ms/step - loss: 0.2286 - accuracy: 0.9265 - val_loss: 0.1547 - val_accuracy: 0.9538
Epoch 19/100
1572/1572 [==============================] - 13s 8ms/step - loss: 0.2251 - accuracy: 0.9275 - val_loss: 0.1606 - val_accuracy: 0.9515
Epoch 20/100
1572/1572 [==============================] - 13s 8ms/step - loss: 0.2176 - accuracy: 0.9300 - val_loss: 0.1562 - val_accuracy: 0.9547
Epoch 21/100
1572/1572 [==============================] - 13s 8ms/step - loss: 0.2126 - accuracy: 0.9317 - val_loss: 0.1678 - val_accuracy: 0.9495
</code></pre>
</div>
</div>
<div id="2da394d5" class="cell markdown"
data-papermill="{&quot;duration&quot;:0.458138,&quot;end_time&quot;:&quot;2023-08-28T18:35:57.214746&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2023-08-28T18:35:56.756608&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<h1 id="plot-the-results-loss-and-accuracy">Plot the results: loss and
accuracy</h1>
<p>Let's take an in-depth look at the loss and accuracy of the
performance of the neural network:</p>
</div>
<div id="9657ddbb" class="cell code" data-execution_count="19"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-08-28T18:35:58.036783Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-08-28T18:35:58.036415Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-08-28T18:35:58.926308Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-08-28T18:35:58.925368Z&quot;}"
data-papermill="{&quot;duration&quot;:1.306458,&quot;end_time&quot;:&quot;2023-08-28T18:35:58.928558&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2023-08-28T18:35:57.622100&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<div class="sourceCode" id="cb30"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>history_frame <span class="op">=</span> pd.DataFrame(history.history)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>history_frame.loc[:, [<span class="st">&#39;loss&#39;</span>, <span class="st">&#39;val_loss&#39;</span>]].plot()</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>history_frame.loc[:, [<span class="st">&#39;accuracy&#39;</span>, <span class="st">&#39;val_accuracy&#39;</span>]].plot()</span></code></pre></div>
<div class="output execute_result" data-execution_count="19">
<pre><code>&lt;Axes: &gt;</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_e131fcf5d1b6404db820e273fc47da45/a17ebad694c403c052bb0b072431fba148bb84c6.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_e131fcf5d1b6404db820e273fc47da45/dcfed097decc20cd87a534cf53a4b7717c230db5.png" /></p>
</div>
</div>
<div id="aaa25ce2" class="cell markdown"
data-papermill="{&quot;duration&quot;:0.409383,&quot;end_time&quot;:&quot;2023-08-28T18:35:59.752059&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2023-08-28T18:35:59.342676&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<h1 id="prediction-time">Prediction Time</h1>
<p>Now let's use our Dataset object for the testing data to try and make
some predictions.</p>
</div>
<div id="d77deda7" class="cell code" data-execution_count="20"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-08-28T18:36:00.623392Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-08-28T18:36:00.623028Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-08-28T18:37:13.434092Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-08-28T18:37:13.433072Z&quot;}"
data-papermill="{&quot;duration&quot;:73.223287,&quot;end_time&quot;:&quot;2023-08-28T18:37:13.436839&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2023-08-28T18:36:00.213552&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<div class="sourceCode" id="cb32"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>predictions <span class="op">=</span> model.predict(test_ds)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>878/878 [==============================] - 72s 81ms/step
</code></pre>
</div>
</div>
<div id="970ce1b2" class="cell code" data-execution_count="21"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-08-28T18:37:14.393251Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-08-28T18:37:14.392897Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-08-28T18:37:14.401508Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-08-28T18:37:14.400503Z&quot;}"
data-papermill="{&quot;duration&quot;:0.492271,&quot;end_time&quot;:&quot;2023-08-28T18:37:14.403563&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2023-08-28T18:37:13.911292&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<div class="sourceCode" id="cb34"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>predictions</span></code></pre></div>
<div class="output execute_result" data-execution_count="21">
<pre><code>array([[4.6309733e-17, 8.2076741e-12, 1.7609805e-14, ..., 5.0773141e-15,
        1.5125445e-19, 4.8730367e-11],
       [1.1467371e-15, 7.5865895e-15, 1.0046218e-16, ..., 7.7496908e-15,
        2.2884797e-12, 3.2032094e-16],
       [3.4791068e-17, 4.9271361e-21, 1.4012276e-23, ..., 2.0323141e-15,
        1.0897205e-17, 8.3412812e-13],
       ...,
       [1.0664964e-14, 7.2284333e-13, 3.4676642e-17, ..., 9.7851683e-12,
        9.3390821e-24, 1.3938878e-09],
       [1.0856621e-21, 4.2370267e-09, 1.7320953e-14, ..., 3.4697714e-15,
        8.8262541e-14, 3.6278539e-10],
       [5.1718277e-18, 9.0966262e-12, 2.5385682e-14, ..., 8.6640036e-15,
        1.8253782e-14, 2.1614521e-14]], dtype=float32)</code></pre>
</div>
</div>
<div id="7be649ce" class="cell markdown"
data-papermill="{&quot;duration&quot;:0.525368,&quot;end_time&quot;:&quot;2023-08-28T18:37:15.413091&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2023-08-28T18:37:14.887723&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<p>Since the result is a 2D array, we need to map each list to the index
of the max element of the corresponding array. Kind of like a manual
softmax at the end of everything.</p>
</div>
<div id="4712a4be" class="cell code" data-execution_count="22"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-08-28T18:37:16.372597Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-08-28T18:37:16.371565Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-08-28T18:37:16.380207Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-08-28T18:37:16.379270Z&quot;}"
data-papermill="{&quot;duration&quot;:0.491197,&quot;end_time&quot;:&quot;2023-08-28T18:37:16.382323&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2023-08-28T18:37:15.891126&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<div class="sourceCode" id="cb36"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>softmax_predictions <span class="op">=</span> np.argmax(predictions, axis<span class="op">=</span><span class="dv">1</span>)</span></code></pre></div>
</div>
<div id="17131ee5" class="cell markdown"
data-papermill="{&quot;duration&quot;:0.476964,&quot;end_time&quot;:&quot;2023-08-28T18:37:17.393974&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2023-08-28T18:37:16.917010&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<p>Finally, add the <code>softmax_predictions</code> list as a new
column in the sorted testing dataframe. Also make the
<code>Class Label</code> column listed as string values.</p>
</div>
<div id="84534f2a" class="cell code" data-execution_count="23"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-08-28T18:37:18.367655Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-08-28T18:37:18.367293Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-08-28T18:37:18.390702Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-08-28T18:37:18.389799Z&quot;}"
data-papermill="{&quot;duration&quot;:0.521575,&quot;end_time&quot;:&quot;2023-08-28T18:37:18.392728&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2023-08-28T18:37:17.871153&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<div class="sourceCode" id="cb37"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>df_test[<span class="st">&#39;Class Label&#39;</span>] <span class="op">=</span> softmax_predictions</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>df_test[<span class="st">&#39;Class Label&#39;</span>] <span class="op">=</span> df_test[<span class="st">&#39;Class Label&#39;</span>].astype(<span class="bu">str</span>)</span></code></pre></div>
</div>
<div id="e07a31dc" class="cell code" data-execution_count="24"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-08-28T18:37:19.446570Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-08-28T18:37:19.446150Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-08-28T18:37:19.459158Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-08-28T18:37:19.458180Z&quot;}"
data-papermill="{&quot;duration&quot;:0.502066,&quot;end_time&quot;:&quot;2023-08-28T18:37:19.461403&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2023-08-28T18:37:18.959337&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<div class="sourceCode" id="cb38"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>df_test</span></code></pre></div>
<div class="output execute_result" data-execution_count="24">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>Class Label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.bmp</td>
      <td>46</td>
    </tr>
    <tr>
      <th>9</th>
      <td>10.bmp</td>
      <td>98</td>
    </tr>
    <tr>
      <th>99</th>
      <td>100.bmp</td>
      <td>75</td>
    </tr>
    <tr>
      <th>999</th>
      <td>1000.bmp</td>
      <td>61</td>
    </tr>
    <tr>
      <th>9999</th>
      <td>10000.bmp</td>
      <td>52</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>9994</th>
      <td>9995.bmp</td>
      <td>133</td>
    </tr>
    <tr>
      <th>9995</th>
      <td>9996.bmp</td>
      <td>40</td>
    </tr>
    <tr>
      <th>9996</th>
      <td>9997.bmp</td>
      <td>94</td>
    </tr>
    <tr>
      <th>9997</th>
      <td>9998.bmp</td>
      <td>36</td>
    </tr>
    <tr>
      <th>9998</th>
      <td>9999.bmp</td>
      <td>52</td>
    </tr>
  </tbody>
</table>
<p>28080 rows × 2 columns</p>
</div>
</div>
</div>
<div id="de9d5f72" class="cell markdown"
data-papermill="{&quot;duration&quot;:0.504065,&quot;end_time&quot;:&quot;2023-08-28T18:37:20.476086&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2023-08-28T18:37:19.972021&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<h3 id="submission">Submission</h3>
</div>
<div id="d9f6b224" class="cell code" data-execution_count="25"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-08-28T18:37:21.634338Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-08-28T18:37:21.633785Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-08-28T18:37:21.748425Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-08-28T18:37:21.747503Z&quot;}"
data-papermill="{&quot;duration&quot;:0.776965,&quot;end_time&quot;:&quot;2023-08-28T18:37:21.751027&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2023-08-28T18:37:20.974062&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<div class="sourceCode" id="cb39"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>df_test.to_csv(<span class="st">&#39;submission.csv&#39;</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;submission successfully saved&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>submission successfully saved
</code></pre>
</div>
</div>
</body>
</html>
